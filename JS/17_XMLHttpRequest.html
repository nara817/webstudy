<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>

    <script>

        /*
            비동기 처리방식
            1. 데이터를 주고 받는 통신(송신, 수신)과정이 순서 없이 처리되는 방식이다.
            2. 응답이 없어도 계속 요청할 수 있는 방식이다.
            3. 페이지를 구성하는 일부 데이터만 요청하고 응답 받을 수 있다.
            4. 이때 JavaScript의 XMLHttpReauest 객체가 사용된다.
        */
        
    </script>

    <div>
        <input type="button" id="btn_req_text" value="텍스트요청">
        <div id="res_text"></div>
    </div>
    <script>

        document.getElementById('btn_req_text').addEventListener('click', () => {
            // 1번부터 4번까지의 텍스트를 싹 긁어서 요기로 대려옴
            /* 1. XMLHttpReauest(xhr) 객체 생성 */
            var xhr = new XMLHttpRequest();
    
            /* 
                2. open - 요청 정보 생성
                    1) 형식 open(HTTP Metyod, URL, Sync/Async)
                    2) HTTP Method
                        (1) GET
                        (2) POST
                    3) URL : 요청하는 서버 경로
                    4) Sync/Async(동기/비동기)
                        (1)Sync(동기) : false
                        (2)Async(비동기) : true - 언제 응답이 오는지 알 수 없음
            */ 
            xhr.open('get', 'data.txt', true);
    
            /* 3. send - 요청하기*/
           xhr.send();
           /* 4. 응답처리하기
                1) 응답되었는지 확인하기 위한 readstatechange 이벤트가 사용된다.
                2) 응답 속성(프로퍼티)
                    (1) readState - 통신 상태 확인
                        ① 0 : OPEND
                        ② 1 : UNSEND
                        ③ 2 : HEADERS_RECEIVE
                        ④ 3 : LOADING
                        ⑤ 4 : DONE (이것만 사용하면 된다.)
                    (2) status - 응답 코드
                        ① 200 : 응답 성공 (이것만 사용하면 된다.)
                        ② 4xx : 요청 실패(사용자 잘못) 
                        ③ 5xx : 응답 실패(서머 문제)
                    (3) 응답 데이터의 형식
                        ① 텍스트 : responseText 
                        ② XML : responseXML
                        ③ JSON : JSON.parse(responseText)
           */
          // readystatechangd 이벤트 등록 - 표준 이벤트
          xhr.addEventListener('readystatechange', () => {
                if(xhr.readyState == 4 && xhr.status == 200){
                    document.getElementById('res_text').textContent = xhr.responseText;
                }
            });

        });

    </script>


    
</body>
</html>